
const jsonArray1 = [{"LENDER NAME":"Sequence Capital","LTV":0.5,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0899,"Lender ":0.01," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Sequence Capital","LTV":0.5,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"Second","Interest Rate":0.1049,"Lender ":0.02," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"MCF","LTV":0.55,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0699,"Lender ":0.015," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":" Agricultural"},{"LENDER NAME":"New Haven","LTV":0.55,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0974,"Lender ":0.01," Term ":""," Amount":" 25k - 1m","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"New Haven","LTV":0.55,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"Second","Interest Rate":0.1099,"Lender ":0.0224," Term ":""," Amount":" 200k Max\nExisting 1st 750k max","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Vault","LTV":0.55,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0849,"Lender ":0.0175," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":"GTA, Barrie, KWC, London"},{"LENDER NAME":"Sequence Capital","LTV":0.6,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0925,"Lender ":0.01," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Sequence Capital","LTV":0.6,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"Second","Interest Rate":0.1125,"Lender ":0.02," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Vault","LTV":0.6,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0875,"Lender ":0.0175," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":"GTA, Barrie, KWC, London"},{"LENDER NAME":"Alta West","LTV":0.65,"FICO":">550","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0829,"Lender ":0.0299," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"TDS 70%\n","Quick Closing":"","Area":""},{"LENDER NAME":"Lendfinity","LTV":0.65,"FICO":"N/A","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.1099,"Lender ":0.03," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":1,"Area":""},{"LENDER NAME":"MCF","LTV":0.65,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0699,"Lender ":0.015," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":" pop. >25,000, well and sceptic, Rural"},{"LENDER NAME":"New Haven","LTV":0.65,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0999,"Lender ":0.0125," Term ":""," Amount":" 25k - 1m","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"New Haven","LTV":0.65,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"Second","Interest Rate":0.1199,"Lender ":0.0299," Term ":""," Amount":" 200k Max\nExisting 1st 750k max","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Oppono","LTV":0.65,"FICO":">650","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0854,"Lender ":0.0199," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Sequence Capital","LTV":0.65,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0949,"Lender ":0.01," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Sequence Capital","LTV":0.65,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"Second","Interest Rate":0.1149,"Lender ":0.02," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Vault","LTV":0.65,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0899,"Lender ":0.0175," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":" GTA, Barrie, KWC, London"},{"LENDER NAME":"Oppono","LTV":0.7,"FICO":">650","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0824,"Lender ":0.0199," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Sequence Capital","LTV":0.7,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0999,"Lender ":0.01," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"","LTV":"","FICO":"","Mortgage Type":"","Mortgage Status":"Second","Interest Rate":0.1195,"Lender ":0.02," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Vault","LTV":0.7,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0925,"Lender ":0.0175," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":" GTA, Barrie, KWC, London"},{"LENDER NAME":"Alta West","LTV":0.75,"FICO":">550","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0849,"Lender ":0.0299," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"TDS 70%\n","Quick Closing":"","Area":""},{"LENDER NAME":"","LTV":"","FICO":"","Mortgage Type":"","Mortgage Status":"Second","Interest Rate":0.1199,"Lender ":0.035," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Brightpath Capital","LTV":0.75,"FICO":">600","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0949,"Lender ":0.0149," Term ":"12 month "," Amount":" 1.5m","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":"pop. 50k+"},{"LENDER NAME":"Extend Financial","LTV":0.75,"FICO":"N/A","Mortgage Type":"Residential ","Mortgage Status":"HELOC","Interest Rate":0.1399,"Lender ":0.03," Term ":"48 months"," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Hosper","LTV":0.75,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0799,"Lender ":""," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Liahona MIC","LTV":0.75,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"","Interest Rate":"","Lender ":""," Term ":"6-24 months"," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"MCF","LTV":0.75,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0699,"Lender ":0.015," Term ":""," Amount":"","Ammortization Period":"\n40 Year ","First mortgage - Miscellaneous":"","Quick Closing":"","Area":"Major Cities"},{"LENDER NAME":"New Haven","LTV":0.75,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.1074,"Lender ":0.0125," Term ":""," Amount":"25k - 1m","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""}];
const jsonArray2 = [{"LENDER NAME":"Oppono","LTV":0.75,"FICO":">650","Mortgage Type":"Residential ","Mortgage Status":"","Interest Rate":0.0824,"Lender ":0.0199," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"OZ Capital","LTV":0.75,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"Second","Interest Rate":0.0999,"Lender ":0.025," Term ":""," Amount":"Amount 500k\nAnywhere in ON","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Sequence Capital","LTV":0.75,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.1099,"Lender ":0.01," Term ":""," Amount":"500k - 1m","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Sequence Capital","LTV":0.75,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"Second","Interest Rate":0.1275,"Lender ":0.02," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Vault","LTV":0.75,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0949,"Lender ":0.0199," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":" GTA, Barrie, KWC, London","Quick Closing":"","Area":" GTA, Barrie, KWC, London"},{"LENDER NAME":"Alta West","LTV":0.8,"FICO":">650","Mortgage Type":"Residential ","Mortgage Status":"Second","Interest Rate":0.1275,"Lender ":0.0375," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Blackhawk Consulting","LTV":0.8,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"Second","Interest Rate":0.1399,"Lender ":0.06," Term ":"12 month term"," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":" anywhere in ON\n"},{"LENDER NAME":"Brightpath Capital","LTV":0.8,"FICO":">680","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0999,"Lender ":0.0199," Term ":""," Amount":" 1.2m","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"CMI","LTV":0.8,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.1199,"Lender ":"8% s"," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":" Anywhere in ON"},{"LENDER NAME":"Hosper","LTV":0.8,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0799,"Lender ":""," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"Bundle into 1st and 2nd","Quick Closing":"","Area":""},{"LENDER NAME":"Hosper","LTV":0.8,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"Second","Interest Rate":0.0899,"Lender ":""," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":1,"Area":""},{"LENDER NAME":"Lendfinity","LTV":0.8,"FICO":"","Mortgage Type":"Residential ","Mortgage Status":"Second","Interest Rate":0.1199,"Lender ":0.03," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":1,"Area":""},{"LENDER NAME":"Oppono","LTV":0.8,"FICO":"> 680","Mortgage Type":"Residential ","Mortgage Status":"","Interest Rate":"","Lender ":""," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Brightpath Capital","LTV":0.85,"FICO":">680","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.1099,"Lender ":0.0299," Term ":""," Amount":"1.2m","Ammortization Period":"","First mortgage - Miscellaneous":"\nFreehold Only","Quick Closing":"","Area":""},{"LENDER NAME":"OZ Capital","LTV":"70% (refi)","FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0899,"Lender ":0.0185," Term ":""," Amount":"1m","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":"Anywhere in ON"},{"LENDER NAME":"Regiis MIC","LTV":"85% (w/ s)","FICO":"","Mortgage Type":"Residential ","Mortgage Status":"","Interest Rate":"","Lender ":""," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Agri roots","LTV":"","FICO":"","Mortgage Type":"Residential ","Mortgage Status":"","Interest Rate":"","Lender ":""," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Hillmont","LTV":"","FICO":"","Mortgage Type":"Residential ","Mortgage Status":"","Interest Rate":"","Lender ":""," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"Construction mortgages","Quick Closing":"","Area":""},{"LENDER NAME":"Oppono","LTV":"","FICO":">680","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0814,"Lender ":0.0199," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Oppono","LTV":"","FICO":">680","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0814,"Lender ":0.0199," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Tribecca","LTV":"","FICO":"","Mortgage Type":"Residential ","Mortgage Status":"","Interest Rate":"","Lender ":""," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"construction mortgages, personal s","Quick Closing":"","Area":""},{"LENDER NAME":"Westboro","LTV":"","FICO":"","Mortgage Type":"Residential ","Mortgage Status":"First","Interest Rate":0.0879,"Lender ":0.03," Term ":"1-2 yr term"," Amount":"","Ammortization Period":"35-40 yr am","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Westboro","LTV":"","FICO":"","Mortgage Type":"Residential ","Mortgage Status":"Secind","Interest Rate":0.1099,"Lender ":0.03," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""},{"LENDER NAME":"Tembo","LTV":"","FICO":"","Mortgage Type":"Residential ","Mortgage Status":"","Interest Rate":"","Lender ":""," Term ":""," Amount":"","Ammortization Period":"","First mortgage - Miscellaneous":"","Quick Closing":"","Area":""}];

// Combine the two arrays
const combinedJsonArray = jsonArray1.concat(jsonArray2);



// sort ascending / descending by interest rate and fee 
// limit to top 5 
// add check for special column -> new column in arr, notes: check for text ex. TDS, etc other stuff
// add all scenarios like quick closing, Area, etc. 


// filter through the array with specified values 
function filter_data(data, mortgageStatus, ltv, fico) {
    return data.filter(item => {
      // Check if each item matches the criteria
      const matchesMortgageStatus = mortgageStatus ? item["Mortgage Status"] === mortgageStatus : true;
      const matchesLTV = ltv ? item["LTV"] == ltv : true;
      const matchesFICO = fico ? item["FICO"] == fico : true;
      
      
      return matchesMortgageStatus && matchesLTV && matchesFICO;
  });
}


// Calculate mortgage function
function calculate_mortgage(appraisal, existing_mortgage, loan_term) {
  return filteredData.map(item => {
      // Calculate the new parameter
      const loanAmount = (item["LTV"] * appraisal) - existing_mortgage;


      const monthlyPayment = (loanAmount / loan_term) * item["Interest Rate"];
      
      // Add the new parameter to the item
      return { ...item, "Loan Amount": loanAmount, "Monthly Payment": monthlyPayment };
  });
}

// these will be the custom fields in cashly 


// custom field format inputData.keyName ex. inputData.Mortgage_status
const mortgage_status='Second'; 
const ltv = 0.80; 
//array doesnt have all fico fields filled out, empty for now but can test
//with value '>550' etc. 
const fico = '>550'; 


// calculating mortgage amounts fields 
const appraisal = 800000;
const existing_mortgage = 500000;
const loan_term = 12 

const filteredData = filter_data(combinedJsonArray, mortgage_status, ltv, fico);
const resultWithNewParameters = calculate_mortgage(appraisal, existing_mortgage,loan_term); 

output = resultWithNewParameters


console.log(output); 